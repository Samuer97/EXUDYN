%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\onlyRST{
+  **University of Innsbruck**, Department of Mechatronics, Innsbruck, Austria

If you like using Exudyn, please add a *star* on github and follow us on 
`Twitter @RExudyn <https://twitter.com/RExudyn>`_ !

+  **Update on Exudyn V1.8.52**: newer examples use ``exudyn.graphics`` instead of ``GraphicsData`` functions. The old models are backwards-compatible, but the updated examples and test models require version 1.8.52 or newer! Install with ``pip install exudyn --pre -U``

+  **NOTE**: for pure installation, use **pip install exudyn** (see further description below)
+  *free, open source* and with plenty of *documentation* and *examples*
+  **pre-built** for Python 3.8 - 3.12 under **Windows**\ , **Linux** and **MacOS** available ( **NEW**\ : now with manylinux2014 compatibility and PEP518 build); build wheels yourself, see `theDoc.pdf <https://github.com/jgerstmayr/EXUDYN/blob/master/docs/theDoc/theDoc.pdf>`_ )
+  Exudyn can be linked to any other Python package, but we explicitly mention: `NGsolve <https://github.com/NGSolve/ngsolve>`_, `OpenAI <https://github.com/openai>`_, `OpenAI gym <https://github.com/openai/gym>`_, `Robotics Toolbox (Peter Corke) <https://github.com/petercorke/robotics-toolbox-python>`_, `Pybind11 <https://github.com/pybind/pybind11>`_

.. |pic1| image:: docs/demo/screenshots/pistonEngine.gif
   :width: 200

.. |pic2| image:: docs/demo/screenshots/hydraulic2arm.gif
   :width: 200

.. |pic3| image:: docs/demo/screenshots/particles2M.gif
   :width: 120

.. |pic4| image:: docs/demo/screenshots/shaftGear.png
   :width: 160

.. |pic5| image:: docs/demo/screenshots/rotor_runup_plot3.png
   :width: 190

.. |pic6| image:: docs/theDoc/figures/DrawSystemGraphExample.png
   :width: 240
   
|pic1| |pic2| |pic3| |pic4| |pic5| |pic6|

Johannes Gerstmayr. Exudyn -- A C++ based Python package for flexible multibody systems. Multibody System Dynamics, 2023. `https://doi.org/10.1007/s11044-023-09937-1 <https://doi.org/10.1007/s11044-023-09937-1>`_

Due to limitations for complex formulas, images and references in .rst files, some (small) details are only available in theDoc.pdf, see the `github page of Exudyn <https://github.com/jgerstmayr/EXUDYN/blob/master/docs/theDoc/theDoc.pdf>`_! There may also be some conversion errors in the auto-generated html pages.

For license, see LICENSE.txt in the root github folder on github!

In addition to the tutorial in the documentation, many ( **250+** ) examples can be downloaded on github under main/pythonDev/Examples and main/pythonDev/TestModels . They are also on ReadTheDocs.

Note that **ChatGPT** and other large language models know Exudyn quite well. They are able to build parts of your code or even full models, see `https://doi.org/10.1007/s11044-023-09962-0 <https://doi.org/10.1007/s11044-023-09962-0>`_

Tutorial videos (\ **new Feb 2024**\ )can be found in the `youtube channel of Exudyn <https://www.youtube.com/playlist?list=PLZduTa9mdcmOh5KVUqatD9GzVg_jtl6fx>`_ !

Enjoy the Python library for multibody dynamics modeling, simulation, creating large scale systems, parameterized systems, component mode synthesis, optimization, ...
}
%`PDF <https://github.com/jgerstmayr/EXUDYN/blob/master/docs/publications/GerstmayrIMSD2022.pdf>`_

%
%.. image:: docs/theDoc/intro2.jpg
%    :width: 100%
%

\mysectionlabel{Installation and Getting Started}{sec:installationandgettingstarted}
\ignoreRST{
The documentation for \codeName is split into this introductory section, including a quick start up, installation, code structure and important hints, 
as well as a larger part containing the \codeName module description and interfaces, theory, references to the accessible items and data structures, solvers, settings and much more. \vspace{6pt} \\
%
How to cite:
\bi
  \item[] Johannes Gerstmayr. Exudyn -- a C++-based Python package for flexible multibody systems. Multibody System Dynamics (2023). \url{https://doi.org/10.1007/s11044-023-09937-1} \cite{Exudyn2023}
%J. Gerstmayr, Exudyn - A C++ based Python package for flexible multibody systems, \\ Proceedings of The 6th Joint International Conference on Multibody System Dynamics and the 10th Asian Conference on Multibody System Dynamics 2020, New Delhi, India, 2022. \exuUrl{https://github.com/jgerstmayr/EXUDYN/blob/master/docs/publications/GerstmayrIMSD2022.pdf}{PDF} \cite{GerstmayrExudyn2022} %\vspace{6pt} \\
%A paper on Exudyn has been presented at the `6th Joint International Conference on Multibody System Dynamics <http://imsdacmd2020.iitd.ac.in>`_ and submitted to the proceedings: J. Gerstmayr, Exudyn - A C++ based Python package for flexible multibody systems, Proceedings of The 6th Joint International Conference on Multibody System Dynamics and the 10th Asian Conference on Multibody System Dynamics 2020, New Delhi, India, 2022. 
\ei
%
Tutorial videos can be found in the \exuUrl{https://www.youtube.com/playlist?list=PLZduTa9mdcmOh5KVUqatD9GzVg_jtl6fx}{youtube channel of Exudyn}.
}
%
\noindent \codeName is hosted on \exuUrl{https://github.com}{GitHub} \cite{EXUDYNgit}:
\bi
  \item \exuUrl{https://github.com/jgerstmayr/EXUDYN}{https://github.com/jgerstmayr/EXUDYN}
\ei
\noindent Online documentation is available at:
\bi
  \item \exuUrl{https://jgerstmayr.github.io/EXUDYN}{https://jgerstmayr.github.io/EXUDYN}
  \item \exuUrl{https://exudyn.readthedocs.io}{https://exudyn.readthedocs.io}
\ei
%
For any comments, requests, issues, bug reports, send an email to: 
\bi
  \item email: \texttt{reply.exudyn@gmail.com}
\ei
Thanks for your contribution!

\mysubsection{Getting started}
This section will show:
\bn
  \item What is \codeName ?
  \item Who is developing \codeName ?
  \item How to install \codeName 
  \item How to link \codeName and Python
  \item Goals of \codeName
  \item Run a simple example in Python
  \item FAQ -- Frequently asked questions
\en

\mysubsubsection{What is \codeName ?}
\codeName -- (fl\mybold{EX}ible m\mybold{U}ltibody \mybold{DYN}amics  -- \mybold{EX}tend yo\mybold{U}r \mybold{DYN}amics) \vspace{6pt}\\
\noindent \codeName is a C++ based Python library for efficient simulation of flexible multibody dynamics systems.
It is the follow up code of the previously developed multibody code HOTINT, which Johannes Gerstmayr started during his PhD-thesis.
It seemed that the previous code HOTINT reached limits of further (efficient) development and it seemed impossible to continue from this code as it was outdated regarding programming techniques and the numerical formulation at the time \codeName was started.

\codeName is designed to easily set up complex multibody models, consisting of rigid and flexible bodies with joints, loads and other components. It shall enable automatized model setup and parameter variations, which are often necessary for system design but also for analysis of technical problems. The broad usability of Python allows to couple a multibody simulation with environments such as optimization, statistics, data analysis, machine learning and others.

The multibody formulation is mainly based on redundant coordinates. This means that computational objects (rigid bodies, flexible bodies, ...) are added as independent bodies to the system. Hereafter, connectors (e.g., springs or constraints) are used to interconnect the bodies. The connectors are using Markers on the bodies as interfaces, in order to transfer forces and displacements.
For details on the interaction of nodes, objects, markers and loads see \refSection{sec:overview:items}. For a non-redundant formulation, see \texttt{ObjectKinematicTree} -- this allows to create tree-structures with minimal coordinates in \codeName.

There are several journal papers of the developers which were using \codeName (list may be incomplete):
\bi
  \item J.\ Gerstmayr. Exudyn -- a C++-based Python package for flexible multibody systems. Multibody System Dynamics (2023). \url{https://doi.org/10.1007/s11044-023-09937-1} \ignoreRST{ \cite{Exudyn2023} }
  \item J.\ Gerstmayr, P.\ Manzl, M.\ Pieber. Multibody Models Generated from Natural Language, Preprint, Research Square, 2023. \url{https://doi.org/10.21203/rs.3.rs-3552291/v1} \ignoreRST{ \cite{ExudynNaturalLanguage2023preprint} }
  \item P.\ Manzl, O.\ Rogov, J.\ Gerstmayr, A.\ Mikkola, G.\ Orzechowski. Reliability Evaluation of Reinforcement Learning Methods for Mechanical Systems with Increasing Complexity.  Preprint, Research Square, 2023. \ignoreRST{\cite{ManzlRL2023}} \url{https://doi.org/10.21203/rs.3.rs-3066420/v1}
  \item S.\ Holzinger, M.\ Arnold, J.\ Gerstmayr. Evaluation and Implementation of Lie Group Integration Methods for Rigid Multibody Systems. Preprint, Research Square, 2023. \ignoreRST{\cite{HolzingerArnoldGerst2023}} \url{https://doi.org/10.21203/rs.3.rs-2715112/v1} 
  \item M.\ Sereinig, P.\ Manzl, and J.\ Gerstmayr. Task Dependent Comfort Zone, a Base Placement Strategy for Autonomous Mobile Manipulators using Manipulability Measures, Robotics and Autonomous Systems, submitted. \cite{Sereinig2023comfortZone}
  \item R.\ Neurauter, J.\ Gerstmayr. A novel motion reconstruction method for inertial sensors with constraints, Multibody System Dynamics, 2022. \cite{NeurauterGerstmayr2023}
  \item M.\ Pieber, K.\ Ntarladima, R.\ Winkler, J.\ Gerstmayr. A Hybrid ALE Formulation for the Investigation of the Stability of Pipes Conveying Fluid and Axially Moving Beams, ASME Journal of Computational and Nonlinear Dynamics, 2022. \ignoreRST{\cite{PieberNtarladima2022}}
  \item S.\ Holzinger, M.\ Schieferle, C.\ Gutmann, M.\ Hofer, J.\ Gerstmayr. Modeling and Parameter Identification for a Flexible Rotor with Impacts. Journal of Computational and Nonlinear Dynamics, 2022. \ignoreRST{\cite{HolzingerSchieferle2022}}
  \item S.\ Holzinger, J.\ Gerstmayr. Time integration of rigid bodies modelled with three rotation parameters, Multibody System Dynamics, Vol. 53(5), 2021. \ignoreRST{\cite{Holzinger2021}}
  \item A.\ Zw{\"o}lfer, J.\ Gerstmayr. The nodal-based floating frame of reference formulation with modal reduction. Acta Mechanica, Vol. 232, pp.  835--851 (2021). \ignoreRST{\cite{ZwoelferGerstmayr2021}}
  \item A.\ Zw{\"o}lfer, J.\ Gerstmayr. A concise nodal-based derivation of the floating frame of reference formulation for displacement-based solid finite elements, Journal of Multibody System Dynamics, Vol. 49(3), pp. 291 -- 313, 2020. \ignoreRST{\cite{ZwoelferGerstmayr2020}}
  \item S.\ Holzinger, J.\ Sch{\"o}berl, J.\ Gerstmayr. The equations of motion for a rigid body using non-redundant unified local velocity coordinates. Multibody System Dynamics, Vol. 48, pp. 283 -- 309, 2020. \ignoreRST{\cite{HolzingerSchoeberl2020}}
\ei

\mysubsubsection{Developers of \codeName and thanks}
\codeName is currently (\the\month-\the\year) developed at the University of Innsbruck.
In the first phase most of the core code is written by Johannes Gerstmayr, implementing ideas that followed out of the project HOTINT \cite{GerstmayrEtAl2013}. 15 years of development led to a lot of lessons learned and after 20 years, a code must be re-designed.

Some important tests for the coupling between C++ and Python have been written by Stefan Holzinger. Stefan also helped to set up the previous upload to GitLab and to test parallelization features.
For the interoperability between C++ and Python, we extensively use \mybold{Pybind11}\cite{pybind11}, originally written by Jakob Wenzel, see \texttt{https://github.com/pybind/pybind11}. Without Pybind11 we couldn't have made this project -- Thanks a lot!

Important discussions with researchers from the community were important for the design and development of \codeName , where we like to mention Joachim Sch{\"o}berl from TU-Vienna who boosted the design of the code with great concepts. 
%During a Comet-K2 cooperation project, several discussions with the TMECH/LCM group in Linz influenced the code development.

The cooperation and funding within the EU H2020-MSCA-ITN project 'Joint Training on Numerical Modelling of Highly Flexible Structures for Industrial Applications' contributes to the development of the code.

The following people have contributed to Python and C++ library implementations, testing, examples or theory:
\bi
  \item Joachim Sch{\"o}berl, TU Vienna (Providing specialized NGsolve \cite{Schoeberl1997,NGsolve2014,NGsolve2022} core library with \texttt{taskmanager} for \mybold{multi-threaded parallelization}; NGsolve mesh and FE-matrices import; highly efficient eigenvector computations)
  \item Stefan Holzinger, University of Innsbruck (Lie group module and solvers in Python, Lie group node; helped with Lie group solvers, geometrically exact beam; testing)
  \item Peter Manzl, University of Innsbruck (ConvexRoll Python and C++ implementation; revised artificialIntelligence, ParameterVariation, robotics and MPI parallelization; providing many figures for theDoc; pip install on linux, wsl with graphics)
  \item Andreas Zw{\"o}lfer, Technical University Munich (theory and examples for FFRF, CMS formulation and ANCF 2D cable prototypes in MATLAB)
  \item Martin Sereinig, University of Innsbruck (special robotics functionality, mobile robots, manipulability measures, robot models)
  \item Michael Pieber, University of Innsbruck (helped in several Python libraries; ComputeODE2Eigenvalues with constraints, FEM and CMS testing; Abaqus import and test files; ANCFCable2D+ALE theory improvements and equations check)
  \item Grzegorz Orzechowski, Lappeenranta University of Technology (coupling with openAI gym and running machine learning algorithms)
  \item Aaron Bacher, University of Innsbruck (helped to integrated OpenVR, connection with Franka Emika Panda)
  \item Martin Arnold, Martin-Luther-University of Halle-Wittenberg (support for explicit and implicit Lie group solvers, especially to theory / jacobians and automatic step size)
  \item Konstantina Ntarladima, University of Innsbruck (ANCFCable2D+ALE theory improvements and equations check)
  \item Alexander Humer, Johannes Kepler University Linz (initial discussions on structure and C++ code)
  \item Qasim Khadim, University of Oulu (suggestion for improved model of HydraulicsActuatorSimple with effective bulk modulus)
  \item Michael Gerbl, University of Innsbruck (figures in the documentation, taken from lecture notes)
  \item examples provided by: Manuel Schieferle, Martin Knapp, Lukas March, Dominik Sponring, David Wibmer, Simon Scheiber
\ei
-- thanks a lot! --
%
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\newpage
\mysubsectionlabel{Installation instructions}{sec:install:installinstructions}
%
\mysubsubsectionlabel{Requirements for \codeName ?}{sec:install:installinstructions:requirements}

\codeName only works with Python. Thus, you need an appropriate Python installation.
So far (2021-07), we tested
\bi
  \item \mybold{Anaconda 2023-07, 64bit, Python 3.11} with Spyder 5.4
  \item \mybold{Anaconda 2021-11, 64bit, Python 3.9}\footnote{older Anaconda3 versions can be downloaded via the repository archive \texttt{https://repo.anaconda.com/archive/}}
  \item Currently, we support Python 3.8 - Python 3.12 \mybold{conda environments} on Windows, Linux and MacOS (please report configurations that do not work on GitHub/issues).
  \item \mybold{Spyder 5.1.5} (with Python 3.9.7, 64bit) and \mybold{Spyder 4.1.3} (with Python 3.7.7, 64bit), which is included in the Anaconda installation\footnote{Note that it is important that Spyder, Python and \codeName  are \mybold{either} 32bit \mybold{or} 64bit and are compiled up to the same minor version, i.e., 3.7.x. There will be a strange .DLL error, if you mix up 32/64bit. It is possible to install both, Anaconda 32bit and Anaconda 64bit -- then you should follow the recommendations of paths as suggested by Anaconda installer.}; Spyder works with all virtual environments
\ei
Many alternative options exist:
\bi
  %\item In case that you have an older CPU, which does not support AVX2, use: \codeName with Python 3.6.5, or compile without AVX flags for your machine.\footnote{e.g.\ Anaconda 32bit with Python3.6 can be downloaded via the repository archive \texttt{https://repo.anaconda.com/archive/} choosing \texttt{Anaconda3-5.2.0-Windows-x86.exe}.}
  %\item Spyder 3.2.8 with Python 3.6.5 32 bit (alternatively 64bit), which is included in the Anaconda installation\footnote{It is important that Spyder, Python and exudyn are \mybold{either} 32bit \mybold{or} 64bit}. 
  \item Users report successful use of \codeName with \mybold{Visual Studio Code}. \mybold{Jupyter} has been tested with some examples; both environments should work with default settings.
  \item Anaconda 2020-11 with \mybold{Python 3.8} and Spyder 4.1.5: no problems except some regular crashes of Spyder, TestSuite runs without problems since \codeName version 1.0.182.
  %\item Anaconda 2021-11 with \mybold{Python 3.9} and Spyder 5.1.5: Tested with current version (1.1.99), TestSuite runs without problems.
  \item Alternative option with more stable Spyder (as compared to Spyder 4.1.3): Anaconda, 64bit, Python 3.6.5)\footnote{Anaconda 64bit with Python3.6 can be downloaded via the repository archive \texttt{https://repo.anaconda.com/archive/} choosing \texttt{Anaconda3-5.2.0-Windows-x86\_64.exe} for 64bit.}
  %\item Spyder 3.2.8 with Python 3.6.5 32 bit (alternatively 64bit), which is included in the Anaconda installation\footnote{It is important that Spyder, Python and exudyn are \mybold{either} 32bit \mybold{or} 64bit. 
%Anaconda3-5.2.0-Windows-x86\_64.exe
\ei
If you plan to extend the C++ code, we recommend to use Microsoft Visual Studio (VS2022) and previously VS2017\footnote{Note: VS2019 has problems with the library 'Eigen' and therefore leads to erroneous results with the sparse solver.} to compile your code, which offers Python 3.x compatibility.
Remember that Python versions and the version of the \codeName module must be identical (e.g., Python 3.9 64 bit \mybold{both} in the \codeName module and e.g.\ in Spyder).

\mysubsubsubsection{Run without Anaconda}
If you do not install Anaconda (e.g., under Linux), make sure that you have the according Python packages installed:
\bi
  \item \texttt{numpy} (used throughout the code, inevitable)
  \item \texttt{matplotlib} (for any plot, also PlotSensor(...))
  \item \texttt{tkinter} (for interactive dialogs, SolutionViewer, etc.)
  \item \texttt{scipy} (needed for eigenvalue computation)
\ei
You can install most of these packages using \texttt{pip install numpy} (Windows) or \texttt{pip3 install numpy} (Linux).
NOTE: as there is only \texttt{numpy} needed (but not for all sub-packages) and \texttt{numpy} supports many variants, we do not add a particular requirement for installation of depending packages. It is not necessary to install \texttt{scipy} as long as you are not using features of \texttt{scipy}. Same reason for \texttt{tkinter} and \texttt{matplotlib}.

For interaction (right-mouse-click, some key-board commands) you need the Python module \texttt{tkinter}. This is included in regular Anaconda distributions (recommended, see below), but on Ubuntu you need to type alike (do not forget the '3', otherwise it installs for Python2 ...):
\bi
  \item[] \texttt{sudo apt-get install python3-tk}
\ei
see also common blogs for your operating system.

%+++++++++++++++++++++++++++++++++++++
\mysubsubsectionlabel{Install \codeName with PIP INSTALLER (pypi.org)}{sec:install:installinstructions:pipinstall}
Pre-built versions of \codeName are hosted on \texttt{pypi.org}, see the project
\bi
 \item \exuUrl{https://pypi.org/project/exudyn}{https://pypi.org/project/exudyn}
\ei
As with most other packages, in the regular case (if your binary has been pre-built) you just need to do
\bi
  \item[] \texttt{pip install exudyn}
\ei
On Ubuntu/Linux, make sure that pip is installed and up-to-date ({\bf update pip to at least 20.3}; otherwise the manylinux wheels will not be accepted!):
\bi 
  \item[] \texttt{sudo apt install python3-pip}
  \item[] \texttt{python3 -m pip install --upgrade}
\ei
Depending on installation the command may read \texttt{pip3} or \texttt{pip}: 
\bi
  \item[] \texttt{pip3 install exudyn}
\ei
For pre-releases (use with care!), add \texttt{-{}-pre} flag:
\bi
  \item[] \texttt{pip install exudyn -{}-pre -U}
\ei
The \texttt{-U} (identical to \texttt{--upgrade}) flag ensures that the current installed version is also updated in case of a change of the micro version (e.g., from version 1.6.119 to version 1.6.164), otherwise, it will only update if you switch to a newer minor version.

In some cases (e.g. for AppleM1 or special Linux versions), your pre-built binary will not work due to some incompatibilities. Then you need to build from source as described in the 'Build and install' sections, \refSection{sec:install:installinstructions:buildwindows}.

\mysubsubsubsection{Troubleshooting pip install}
Pip install may fail, if your linux version does not support the current manylinux version.
This was known for Red Hat, CentOS, Rocky Linux or simlilar systems which usually support manylinux2014. In this case, you had to build \codeName from source, see \refSection{sec:install:installinstructions:buildubuntu}. Since version 1.7.116, the manylinux2014 version is supported and according problems should be solved.

Sometimes, you install exudyn, but when running python, the \texttt{import exudyn} fails.
In case of several environments, check where your installation goes. To guarantee that the pip install goes to the python call, use:
\bi 
  \item[] \texttt{python -m pip install exudyn} 
\ei
which ensures that the used python is calling its associated pip module.

If the PyPi index is not updated, it may help to use 
\bi 
  \item[] \texttt{pip install -i https://pypi.org/project/ exudyn}
\ei

%+++++++++++++++++++++++++++++++++++++
\mysubsubsectionlabel{Install from specific Wheel (Ubuntu and Windows)}{sec:install:installinstructions:wheel}
A way to install the Python package \codeName is to use the so-called 'wheels' (file ending \texttt{.whl}).
NOTE that this approach usually is not required; just use the pip installer of the previous section!

\noindent \mybold{Ubuntu}:\vspace{6pt}\\
Wheels can be downloaded directly from \exuUrl{https://pypi.org/project/exudyn/\#files}{https://pypi.org/project/exudyn/\#files}, for many Python versions and architectures.
\vspace{6pt}\\
For Ubuntu 18.04 (which by default uses Python 3.6) this may read (version number 1.0.20 may be different):
\bi
  \item \texttt{Python 3.6, 64bit}: pip3 install dist$\backslash$exudyn-1.0.20-cp36-cp36-linux\_x86\_64.whl
\ei
For Ubuntu 20.04 (which by default uses Python 3.8) this may read (version number 1.0.20 may be different):
\bi
  \item \texttt{Python 3.8, 64bit}: pip3 install dist$\backslash$exudyn-1.0.20-cp38-cp38-linux\_x86\_64.whl
\ei
NOTE that your installation may have environments with different Python versions, so install that \codeName version appropriately!
If the wheel installation does not work on Ubuntu, it is highly recommended to build \codeName for your specific system as given in \refSection{sec:install:installinstructions:buildubuntu}.

\noindent \mybold{Windows}:\vspace{6pt}\\
First, open an Anaconda prompt:
\bi
  \item EITHER calling: START->Anaconda->... OR go to anaconda/Scripts folder and call activate.bat
  \item You can check your Python version then, by running \texttt{python}\footnote{\texttt{python3} under Ubuntu 18.04}, the output reads like:
  \bi
    \item[] \texttt{Python 3.6.5 \textbar Anaconda, Inc.\textbar\ (default, Mar 29 2018, 13:32:41) \lbrack MSC v.1900 64 bit (AMD64)\rbrack\ on win32}
    \item[] ...
  \ei
  \item type \texttt{exit()} to close Python
\ei
%
%\noindent \mybold{Go to the folder} \texttt{Exudyn\_git/main} (where \texttt{setup.py} lies) and choose the wheel in subdirectory \texttt{main/dist} according to your system (windows/UBUNTU), Python version (3.6 or 3.7) and 32 or 64 bits.
%
For Windows the installation commands may read (version number 1.0.20 may be different):
\bi
  \item \texttt{Python 3.6, 32bit}: pip install dist$\backslash$exudyn-1.0.20-cp36-cp36m-win32.whl
  \item \texttt{Python 3.6, 64bit}: pip install dist$\backslash$exudyn-1.0.20-cp36-cp36m-win\_amd64.whl
  \item \texttt{Python 3.7, 64bit}: pip install dist$\backslash$exudyn-1.0.20-cp37-cp37m-win\_amd64.whl
\ei

%%+++++++++++++++++++++++++++++++++++++
%\mysubsubsection{Work without installation and editing \texttt{sys.path}}
%The \mybold{uncommon and old way} ($\ra$ not recommended for \codeName versions $\ge$ 1.0.0) is to use Python's \texttt{sys} module to link to your \texttt{exudyn} (previously \texttt{WorkingRelease}) directory, for example:
%\pythonstyle\begin{lstlisting}
  %import sys
  %sys.path.append('C:/DATA/cpp/EXUDYN_git/bin/EXUDYN32bitsPython36')
%\end{lstlisting}
%
%The folder \texttt{EXUDYN32bitsPython36} needs to be adapted to the location of the according \codeName package.
%In case of 64bit, it must be changed to \texttt{.... /bin/WorkingRelease64}.

%In the future, there will also be a possibility to install the module using pip commands -- we are happy, if somebody could do this!

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\mysubsubsectionlabel{Build and install \codeName under Windows 10?}{sec:install:installinstructions:buildwindows}
%\label{sec:build:windows}
Note that there are a couple of pre-requisites, depending on your system and installed libraries. For Windows 10, the following steps proved to work:
\bi
  \item you need an appropriate compiler (tested with Microsoft Visual Studio; recommended: VS2017)
  \item install your Anaconda distribution including Spyder
  \item close all Python programs (e.g. Spyder, Jupyter, ...) 
  \item run an Anaconda prompt (may need to be run as administrator)
  \item if you cannot run Anaconda prompt directly, do:
  \bi
    \item open windows shell (cmd.exe) as administrator (START $\ra$ search for cmd.exe $\ra$ right click on app $\ra$ 'run as administrator' if necessary) [may not be necessary]
    \item go to your Scripts folder inside the Anaconda folder (e.g. \texttt{C:$\backslash$ProgramData$\backslash$Anaconda$\backslash$Scripts}) [may not be necessary]
    \item run 'activate.bat' [may not be necessary]
  \ei
  \item go to 'main' of your cloned github folder of \codeName 
  \item run:\footnote{Since version 1.7.116 a PEP518 compatible build is available. This should work with Windows, MacOS and linux. The \texttt{setupPyConfig.json} file includes some flags such as the parallel compilation, GLFW, etc.; the \texttt{-v} flag adds verbosity.} \texttt{pip wheel . -v -w dist --no-deps}
  \item Before version 1.7.116: run:\footnote{the \texttt{--parallel} option performs parallel compilation on multithreaded CPUs and can speedup by 2x - 8x} \texttt{python setup.py install --parallel}
  \item read the output; if there are errors, try to solve them by installing appropriate modules
\ei
You can also create your own wheels, doing the above steps to activate the according Python version and then calling:
\bi
  \item[] \texttt{python setup.py bdist\_wheel --parallel}
\ei
This will add a wheel in the \texttt{dist} folder.

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\mysubsubsectionlabel{Build and install \codeName under Mac OS X?}{sec:install:installinstructions:buildmacos}
%\label{sec:build:MacOS}
Installation and building on Mac OS X is less frequently tested, but successful compilation including GLFW has been achieved.
Requirements are an according Anaconda (or Miniconda) installation.

\noindent \mybold{Tested configurations}:
\bi
  \item Mac OS 11.x 'Big Sur', Mac Mini (2021), Apple M1, 16GB Memory
  \item Miniconda with conda environments (x86 / i368 based with Rosetta 2) with Python 3.7 - 3.11
  \item Miniconda with conda environments (ARM) with Python 3.8 - 3.11
  \item[] $\ra$ wheels are available on pypi since \codeName 1.5.0 
\ei
\noindent \mybold{NOTE}:
\bi
  \item New \texttt{universal2} wheels should support x86 (APPLE Intel and Python/Rosetta on APPLE Silicon)
  \item Multi-threading is not fully supported on MacOS, but may work in some applications
  \item On Apple M1 processors the newest Anaconda supports now all required features; environments with Python 3.8-3.11 have been successfully tested;
  \item The Rosetta (x86 emulation) mode on Apple M1 also works now without much restrictions; these files should also work on older Macs
  \item If you have a MacOS version$<11$, it worked to download wheels from PyPI, change wheel names, e.g., from \texttt{exudyn-1.7.116.dev1-cp311-cp311-macosx\_11\_0\_x86\_64.whl} to \texttt{exudyn-1.7.116.dev1-cp311-cp311-macosx\_10\_9\_x86\_64.whl}. This also works for universal2 files. Installation worked and wheels were running smoothly.
  \item \texttt{tkinter} has been adapted (some workarounds needed on MacOS!), available since \codeName 1.5.15.dev1
  \item Some optimization and processing functions do not run (especially multiprocessing and tqdm); 
\ei

Alternatively, we tested on:
\bi
  \item Mac OS X 10.11.6 'El Capitan', Mac Pro (2010), 3.33GHz 6-Core Intel Xeon, 4GB Memory, Anaconda Navigator 1.9.7, Python 3.7.0, Spyder 3.3.6
\ei
%
\vspace{9pt}
\mybold{Compile from source}:\vspace{3pt}\\
If you would like to compile from source, just use a bash terminal on your Mac, and do the following steps inside the \texttt{main} directory of your repository and type
\bi
  \item uninstall if old version exists (may need to repeat this!): \texttt{pip uninstall exudyn}
  \item remove the \texttt{build} directory if you would like to re-compile without changes
  \item to perform compilation from source, write:\footnote{the \texttt{--parallel} option performs parallel compilation on multithreaded CPUs and can speedup by 2x - 8x}
  \item Since version 1.7.116: \texttt{pip wheel . -v -w dist --no-deps}
  \item Until version 1.7.116: \texttt{python setup.py bdist\_wheel --parallel}
  \item which takes 75 seconds on Apple M1 in parallel mode, otherwise 5 minutes. To install \codeName, run
  \item[] \texttt{python setup.py install}
  \item[] $\ra$ this will only install, but not re-compile. Otherwise, just use pip install from the created wheel in the dist folder
  \item[] \mybold{NOTE} that conda environments are highly recommended
  %\item[] $\ra$ it may produce some errors, depending on your version; if there are some liker errors (saying that there is no '\texttt{-framework Cocoa' and '-framework OpenGL}', just go back in the terminal and copy everything from '\texttt{g++ ...}' until the end of the last command '\texttt{-mmacosx-verion-min...}' and paste it into the terminal. Calling that again will finalize linking; then run again
  %%\item[] \texttt{python setup.py bdist\_wheel}
  %\item[] $\ra$ this now creates the wheel (if you want to distribute) in the \texttt{dist} folder; note that this wheel has a wrong version number (11.0) while it may need to be changed to 10.9 manually in order that it can be installed
  %\item \texttt{python setup.py install}
  %\item[] to install exudyn
\ei
Then just go to the \texttt{pythonDev/Examples} folder and run an example:
\bi
  \item[] \texttt{python springDamperUserFunctionTest.py}
\ei
If there are other issues, we are happy to receive your detailed bug reports. 

\noindent Note that you need to run 
\pythonstyle\begin{lstlisting}
  exudyn.StartRenderer()
  exudyn.DoRendererIdleTasks(-1)
\end{lstlisting}
in order to interact with the render window, as there is only a single-threaded version available for Mac OS.

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\mysubsubsectionlabel{Build and install \codeName under Ubuntu?}{sec:install:installinstructions:buildubuntu}
%
Having a new Ubuntu 18.04 standard installation (e.g. using a VM virtual box environment), the following steps need to be done (Python \mybold{3.6} is already installed on Ubuntu 18.04, otherwise use \texttt{sudo apt install python3})\footnote{see also the youtube video: \exuUrl{https://www.youtube.com/playlist?list=PLZduTa9mdcmOh5KVUqatD9GzVg\_jtl6fx}{https://www.youtube.com/playlist?list=PLZduTa9mdcmOh5KVUqatD9GzVg\_jtl6fx}}:

\noindent First update ...
\plainlststyle
\begin{lstlisting}
  sudo apt-get update
\end{lstlisting}

\noindent 
Install necessary Python libraries and pip3; \texttt{matplotlib} and \texttt{scipy} are not required for installation but used in \codeName examples:
\begin{lstlisting}
  sudo dpkg --configure -a
  sudo apt install python3-pip
  pip3 install numpy
  pip3 install matplotlib
  pip3 install scipy
\end{lstlisting}

\noindent Install pybind11 (needed for running the setup.py file derived from the pybind11 example):
\begin{lstlisting}
  pip3 install pybind11
\end{lstlisting}

\noindent To have dialogs enabled, you need to install \texttt{Tk}/\texttt{tkinter} (may be already installed in your case). 
\texttt{Tk} is installed on Ubuntu via apt-get and should then be available in Python:
\begin{lstlisting}
  sudo apt-get install python3-tk
\end{lstlisting}

\noindent 
If graphics is used (\texttt{\#define USE\_GLFW\_GRAPHICS} in \texttt{BasicDefinitions.h}), you must install the according GLFW libs:
\begin{lstlisting}
  sudo apt-get install libglfw3 libglfw3-dev
\end{lstlisting}

In some cases, it may be required to install OpenGL and some of the following libraries:
\begin{lstlisting}
  sudo apt-get install freeglut3 freeglut3-dev
  sudo apt-get install mesa-common-dev
  sudo apt-get install libx11-dev xorg-dev libglew1.5 libglew1.5-dev libglu1-mesa libglu1-mesa-dev libgl1-mesa-glx libgl1-mesa-dev
\end{lstlisting}

\noindent 
With all of these libs, you can run the setup.py installer (go to \texttt{Exudyn\_git/main} folder), which takes some minutes for compilation (the --user option is used to install in local user folder)\footnote{the \texttt{--parallel} option performs parallel compilation on multithreaded CPUs and can speedup by 2x - 8x}:
\begin{lstlisting}
  sudo python3 setup.py install --user --parallel
\end{lstlisting}
Since version 1.7.116, a PEP518 compatible way to compile sources and install the current repository has been added (the \texttt{-v} flag activates a verbose mode):
\begin{lstlisting}
  pip install . -v --no-deps
\end{lstlisting}

\noindent 
Congratulation! \mybold{Now, run a test example} (will also open an OpenGL window if successful):
\bi
  \item[] \texttt{python3 pythonDev/Examples/rigid3Dexample.py}
\ei

\noindent You can also create a Ubuntu wheel which can be easily installed on the same machine (x64), same operating system (Ubuntu 18.04) and with same Python version (e.g., 3.6):
\bi
  \item[] \texttt{sudo pip3 install wheel}
  \item[] \texttt{sudo python3 setup.py bdist\_wheel --parallel}
\ei

\noindent Since version 1.7.116, the PEP518 compatible way which puts wheels into the \texttt{dist} folder reads:
\bi
  \item[] \texttt{pip wheel . -v -w dist --no-deps}
\ei


\noindent \mybold{Exudyn under Ubuntu / WSL}:
\bi
  \item Note that \codeName also nicely works under WSL (Windows subsystem for linux; tested for Ubuntu 18.04) and an according xserver (VcXsrv).
  \item In case of old WSL2, just set the display variable in your .bashrc file accordingly and you can enjoy the OpenGL windows and settings.
  \item It shall be noted that WSL + xserver works better than on MacOS, even for tkinter, multitasking, etc.! So, if you have troubles with your Mac, use a virtual machine with ubuntu and a xserver, that may do better
  \item In case of WSLg (since 2021), only the software-OpenGL works; therefore, you have to set (possibly in .bashrc file): \texttt{export LIBGL\_ALWAYS\_SOFTWARE=0}
\ei

\noindent \mybold{Exudyn under RaspberryPi 4b}:
\bi
  \item Exudyn also compiles under RaspberryPi 4b, Ubuntu Mate 20.04, Python 3.8; current version should compile out of the box using \texttt{python3 setup.py install} command.
  \item Performance is quite ok and it is even capable to use all cores (but you should add a fan!)
  \item $\ra$ this could lead to a nice cluster project!
\ei

\noindent \mybold{KNOWN issues for linux builds}:
\bi
  \item Using \mybold{WSL2} (Windows subsystem for linux), there occur some conflicts during build because of incompatible windows and linux file systems and builds will not be copied to the dist folder; workaround: go to explorer, right click on 'build' directory and set all rights for authenticated user to 'full access'
  \item \mybold{compiler (gcc,g++) conflicts}: It seems that \codeName works well on Ubuntu 18.04 with the original \texttt{Python 3.6.9} and \texttt{gcc-7.5.0} version as well as with Ubuntu 20.04 with \texttt{Python 3.8.5} and \texttt{gcc-9.3.0}. Upgrading \texttt{gcc} on a Linux system with Python 3.6 to, e.g., \texttt{gcc-8.2} showed us a linker error when loading the \codeName module in Python -- there are some common restriction using \texttt{gcc} versions different from those with which the Python version has been built. Starting \texttt{python} or \texttt{python3} on your linux machine shows you the \texttt{gcc} version it had been build with. Check your current \texttt{gcc} version with: \texttt{gcc --version}
\ei

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\mysubsubsectionlabel{Uninstall \codeName}{sec:install:installinstructions:uninstall}

To uninstall exudyn under Windows, run (may require admin rights):
\bi
  \item[] \texttt{pip uninstall exudyn}
\ei
\noindent To uninstall under Ubuntu, run:
\bi
  \item[] \texttt{sudo pip3 uninstall exudyn}
\ei

If you upgrade to a newer version, uninstall is usually not necessary!
%
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\mysubsubsection{How to install \codeName and use the C++ source code (advanced)?}
\codeName is still under intensive development of core modules.
There are several ways of using the code, but you \mybold{cannot} install \codeName as compared to other executable programs and apps.
\vspace{6pt}\\
%\mybold{Ways to use \codeName }:
In order to make full usage of the C++ code and extending it, you can use:
\bi
  \item Windows / Microsoft Visual Studio 2017 and above:
  \bi
    \item get the files from git
    \item put them into a local directory (recommended: \texttt{C:/DATA/cpp/EXUDYN\_git})
    \item start \texttt{main\_sln.sln} with Visual Studio (recommended version: 2017, otherwise you have to manually adapt)
    \item compile the code and run \texttt{main/pythonDev/pytest.py} example code
    \item adapt \texttt{pytest.py} for your applications
    \item extend the C++ source code
    \item link it to your own code
    \item NOTE: on Linux systems, you mostly need to replace '$/$' with '$\backslash$'
  \ei
  \item Linux, etc.: Use the build methods described above; Visual Studio Code may allow native Python and C++ debugging; switching to other build mechanisms (CMakeLists or scikit-build-core).
\ei
%
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\mysubsection{Further notes}
\mysubsubsectionlabel{Goals of \codeName}{sec:install:notes:goals}
After the first development phase (2019-2023), it
\bi
  \item is a moderately large \footnote{wheels have only sizes of 2MB on Windows and 4MB on Linux, without fast Exudyn options} multibody library, which can be easily linked to other projects,
  \item contains basic multibody rigid bodies, flexible bodies, joints, contact, etc.,
  \item includes a large Python utility library for convenient building and post processing of models,
  \item allows to efficiently simulate small scale systems (compute $100\,000$s of time steps per second for systems with $n_{DOF}<10$),
  \item allows to efficiently simulate medium scaled systems for problems with $n_{DOF} < 1\,000\,000$,
  \item is a safe and widely accessible module for Python,
  \item allows to add user defined objects and solvers in C++,
  \item allows to add user defined objects and solvers in Python,
  \item allows multi-threaded parallel computing,
  \item includes Lie group integration,
  \item includes interfaces for robotics and ROS,
  \item includes interfaces for reinforcement learning (stable-baselines3), pytorch and artificial intelligence,
  \item includes kinematical trees with minimal coordinates.
\ei
Future goals (2024-2026) are:
\bi
  \item add specific and advanced connectors/constraints (extended wheels, contact, control connector)
  \item automatic step size selection for second order solvers (planned 2025),
  \item add 3D beams and plates (first attempts exist; planned 2024),
  \item export equations (planned, 2025),
  \item add GPU support (planned, 2025).
\ei
For solved issues (and new features), see section 'Issues and Bugs', \refSection{sec:issueTracker}.
For specific open issues, see \texttt{trackerlog.html} -- a document only intended for developers!
%
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\mysubsectionlabel{Run a simple example in Python}{sec:install:simpleexample}
After performing the steps of the previous section, this section shows a simplistic model which helps you to check if \codeName runs on your computer.

In order to start, run the Python interpreter Spyder (or any preferred Python environment).
In order to test the following example, which creates a \ac{mbs}, adds a node, an object, a marker and a load and simulates everything with default values, 
\bi
\ignoreRST{
\item open Spyder and copy the example provided in Listing \ref{lst:firstexample} into a new file, or}
\item open \texttt{myFirstExample.py} from your \texttt{Examples} folder.
\ei
Hereafter, press the play button or \texttt{F5} in Spyder.
%\lstinputlisting[language=Python]{../../main/bin/WorkingRelease/myFirstExample.py}
\ignoreRST{
\pythonexternal[language=Python, frame=single, float, label=lst:firstexample, caption=My first example]{../../main/pythonDev/Examples/myFirstExample.py}
}

If successful, the IPython Console of Spyder will print something like:
\begin{lstlisting}
  runfile('C:/DATA/cpp/EXUDYN_git/main/pythonDev/Examples/myFirstExample.py', 
    wdir='C:/DATA/cpp/EXUDYN_git/main/pythonDev/Examples')
  +++++++++++++++++++++++++++++++
  EXUDYN V1.2.9 solver: implicit second order time integration
  STEP100, t = 1 sec, timeToGo = 0 sec, Nit/step = 1
  solver finished after 0.0007824 seconds.
\end{lstlisting}
  %runfile('C:/DATA/cpp/EXUDYN_git/main/bin/WorkingRelease/myFirstExample.py', 
    %wdir='C:/DATA/cpp/EXUDYN_git/main/bin/WorkingRelease')

If you check your current directory (where \texttt{myFirstExample.py} lies), you will find a new file \texttt{coordinatesSolution.txt}, which contains the results of your computation (with default values for time integration).
The beginning and end of the file should look like: \vspace{6pt}\\
\begin{lstlisting}
  #Exudyn implicit second order time integration solver solution file
  #simulation started=2022-04-07,19:02:19
  #columns contain: time, ODE2 displacements, ODE2 velocities, ODE2 accelerations
  #number of system coordinates [nODE2, nODE1, nAlgebraic, nData] = [2,0,0,0]
  #number of written coordinates [nODE2, nVel2, nAcc2, nODE1, nVel1, nAlgebraic, nData] = [2,2,2,0,0,0,0]
  #total columns exported  (excl. time) = 6
  #number of time steps (planned) = 100
  #Exudyn version = 1.2.33.dev1; Python3.9.11; Windows AVX2 FLOAT64
  #
  0,0,0,0,0,0.0001,0
  0.01,5e-09,0,1e-06,0,0.0001,0
  0.02,2e-08,0,2e-06,0,0.0001,0
  0.03,4.5e-08,0,3e-06,0,0.0001,0
  0.04,8e-08,0,4e-06,0,0.0001,0
  0.05,1.25e-07,0,5e-06,0,0.0001,0

  ...

  0.96,4.608e-05,0,9.6e-05,0,0.0001,0
  0.97,4.7045e-05,0,9.7e-05,0,0.0001,0
  0.98,4.802e-05,0,9.8e-05,0,0.0001,0
  0.99,4.9005e-05,0,9.9e-05,0,0.0001,0
  1,5e-05,0,0.0001,0,0.0001,0
  #simulation finished=2022-04-07,19:02:19
  #Solver Info: stepReductionFailed(or step failed)=0,discontinuousIterationSuccessful=1,newtonSolutionDiverged=0,massMatrixNotInvertible=1,total time steps=100,total Newton iterations=100,total Newton jacobians=100
\end{lstlisting}
%
Within this file, the first column shows the simulation time and the following columns provide coordinates, their derivatives and Lagrange multipliers on system level. For relation of local to global coordinates, see \refSection{sec:overview:ltgmapping}. As expected, the $x$-coordinate of the point mass has constant acceleration $a=f/m=0.001/10=0.0001$, the velocity grows up to $0.0001$ after 1 second and the point mass moves $0.00005$ along the $x$-axis.

Note that line 8 contains the \codeName and Python versions\footnote{as well as some other specific information on the platform and compilation settings (which may help you identify with which computer, etc., you created results)} provided in the solution file are the versions at which Exudyn has been compiled with.
The Python micro version (last digit) may be different from the Python version from which you were running Exudyn.
This information is also provided in the sensor output files.
%
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\newpage
\mysubsectionlabel{Trouble shooting and FAQ}{sec:install:troubleshootingfaq}

\mysubsubsection{Trouble shooting}
\codeName has a solid exception handling and does lots of error checking on
inputs as well as during computations. This should usually not lead to an
unexpected crash as in early days of scientific codes.

For basic information on exception handling, see also the according section on
Exceptions and Error Messages. In the following, typical error messages are listed. 

\noindent \mybold{Python import errors}:
\bi
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  \item Sometimes the \codeName module cannot be loaded into Python. Typical \mybold{error messages if Python versions are not compatible} are: \vspace{1pt}\\
\plainlststyle
\begin{lstlisting}
  Traceback (most recent call last):

    File "<ipython-input-14-df2a108166a6>", line 1, in <module>
      import exudynCPP

  ImportError: Module use of python36.dll conflicts with this version of Python.
\end{lstlisting}
%
Typical \mybold{error messages if 32/64 bits versions are mixed}:\vspace{1pt}\\
\begin{lstlisting}
  Traceback (most recent call last):
  
    File "<ipython-input-2-df2a108166a6>", line 1, in <module>
      import exudynCPP

  ImportError: DLL load failed: \%1 is not a valid Win32 application.
\end{lstlisting}
%
\mybold{There are several reasons and workarounds}:
\bi
\item[$\ra$] You mixed up 32 and 64 bits version (see below) 
\item[$\ra$] You are using an exudyn version for Python $x_1.y_1$ (e.g., 3.6.$z_1$) different from the Python $x_2.y_2$ version in your Anaconda (e.g., 3.7.$z_2$); note that $x_1=x_2$ and $y_1=y_2$ must be obeyed while $z_1$ and $z_2$ may be different
\ei
%
\item \mybold{Import of exudyn C++ module failed Warning: ...}:
\bi
\item[$\ra$] ... and similar messages with: ModuleNotFoundError, Warning, with AVX2, without AVX2
\item[$\ra$] A known reason is that your CPU \mybold{does not support AVX2}, while \codeName is compiled with the AVX2 option\footnote{modern Intel Core-i3, Core-i5 and Core-i7 processors as well as AMD processors, especially Zen and Zen-2 architectures should have no problems with AVX2; however, low-cost Celeron, Pentium and older AMD processors do \mybold{not} support AVX2, e.g.,  Intel Celeron G3900, Intel core 2 quad q6600, Intel Pentium Gold G5400T; check the system settings of your computer to find out the processor type; typical CPU manufacturer pages or Wikipedia provide information on this}.
\item[$\ra$] \mybold{solution}: the release versions without the .dev1 ending in the wheel contain C++ libraries which are compiled without AVX/AVX2; the module loader will usually detect automatically, if your CPU supports AVX/AVX2; if not, it will load the exudynCPPnoAVX.cp ... .pyd file; if this does not work, try\\
\texttt{import sys}\\
\texttt{sys.exudynCPUhasAVX2 = False}\\
to explicitly load the version without AVX2.
\item[$\ra$] you can also compile for your specific Python version without AVX if you adjust the \texttt{setup.py} file in the \texttt{main} folder.
\item[$\ra$] \mybold{DEPRECATED workaround} to solve the AVX problem: use the Python 3.6 version (up to \codeName V1.2.28 only the 32bit version), which is compiled without AVX2.
\item[$\ra$] The \texttt{ModuleNotFoundError} may also happen if something went wrong during installation (paths, problems with Anaconda, ..) $\ra$ very often a new installation of Anaconda and \codeName helps.
\ei
\ei
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\noindent \mybold{Typical Python errors}:
\bi
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  \item Typical Python \mybold{syntax error} with missing braces:
\plainlststyle
\begin{lstlisting}
  File "C:\DATA\cpp\EXUDYN_git\main\pythonDev\Examples\springDamperTutorial.py", line 42
      nGround=mbs.AddNode(NodePointGround(referenceCoordinates = [0,0,0]))
             ^
  SyntaxError: invalid syntax
\end{lstlisting}
\onlyRST{\rstStartNewLine}
%
\item[$\ra$] such an error points to the line of your code (line 42), but in fact the error may have been caused in previous code, such as in this case there was a missing brace in the line 40, which caused the error:
\pythonstyle\begin{lstlisting}
  38  n1=mbs.AddNode(Point(referenceCoordinates = [L,0,0],
  39                       initialCoordinates = [u0,0,0],
  40                       initialVelocities= [v0,0,0])
  41  #ground node
  42  nGround=mbs.AddNode(NodePointGround(referenceCoordinates = [0,0,0]))
  43  
\end{lstlisting}
%
%
\item Typical Python \mybold{import error} message on Linux / Ubuntu if Python modules are missing:
\plainlststyle
\begin{lstlisting}
  Python WARNING [file '/home/johannes/.local/lib/python3.6/site-packages/exudyn/solver.py', line 236]: 
  Error when executing process ShowVisualizationSettingsDialog':
  ModuleNotFoundError: No module named 'tkinter'
\end{lstlisting}
\onlyRST{\rstStartNewLine}
%
\item[$\ra$] see installation instructions to install missing Python modules, \refSection{sec:install:installinstructions}.

\item Problems with \mybold{tkinter}, especially on MacOS:\\
  \codeName uses \texttt{tkinter}, based on tcl/tk, to provide some basic dialogs, such as visualizationSettings\\
  As Python is not suited for multithreading, this causes problems in window and dialog workflows. Especially on MacOS
  \texttt{tkinter} is less stable and compatible with the window manager. Especially, \texttt{tkinter} already needs to run
  before the application's OpenGL window (renderer) is opened. Therefore, on MacOS \texttt{tkinter.Tk()} is called before the 
  renderer is started.
  In some cases, visualizationSettings dialog may not be available and changes have to be made inside the code.
  
\item[$\ra$] To resolve issues, the following visualizationSettings may help (before starting renderer!), but may reduce functionality: 
     dialogs.multiThreadedDialogs = False, general.useMultiThreadedRendering = False
\ei 



%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\noindent \mybold{Typical solver errors}:
\bi
\item Consider the  example for a mixed error message comes from the solver when called for a (possibly empty) \texttt{mbs} with no prior call to \texttt{mbs.Assemble()}:
\plainlststyle
\begin{lstlisting}
  import exudyn as exu
  from exudyn.utilities import *
  SC = exu.SystemContainer()
  mbs = SC.AddSystem()
  sims=exu.SimulationSettings()
  exu.SolveDynamic(mbs, sims)
\end{lstlisting}
\item This will results in error messages similar to:
\begin{lstlisting}
  =========================================
  User ERROR [file 'C:\Users\username\.conda\envs\venvP39\lib\site-packages\exudyn\solver.py', line 245]: 
  Solver: system is inconsistent and cannot be solved (call Assemble() and check error messages)
  =========================================

  =========================================
  SYSTEM ERROR [file 'C:\Users\username\.conda\envs\venvP39\lib\site-packages\exudyn\solver.py', line 245]: 
  EXUDYN raised internal error in 'CSolverBase::InitializeSolver':
  Exudyn: parsing of Python file terminated due to Python (user) error
  =========================================

  ******************************
  DYNAMIC SOLVER FAILED:
    use showHints=True to show helpful information
  ******************************
   
  Traceback (most recent call last):

    File "C:\Users\username\AppData\Local\Temp\ipykernel_24988\3348856385.py", line 1, in <module>
      exu.SolveDynamic(mbs, sims)

    File "C:\Users\username\.conda\envs\venvP39\lib\site-packages\exudyn\solver.py", line 255, in SolveDynamic
      raise ValueError("SolveDynamic terminated")

  ValueError: SolveDynamic terminated
\end{lstlisting}
\onlyRST{\rstStartNewLine}
\bi
\item[$\ra$] it seems clear that you should read this error from top as it indicates that you just forgot to call \texttt{mbs.Assemble()}
\ei
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item WSL/Ubuntu: render window crashes after left or right mouse click:
\bi
\item[$\ra$] This happens, in some (all?) Linux installations during mouse selection
\item[$\ra$] workaround: setting \texttt{SC.visualizationSettings.interactive.selectionLeftMouse = False} and \texttt{SC.visualizationSettings.interactive.selectionRightMouse = False} removes the option to select with mouse, but avoids crashes
\ei
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item \texttt{SolveDynamic} or \texttt{SolveStatic} \mybold{terminated due to errors}:
\bi
\item[$\ra$] use flag \texttt{showHints = True} in \texttt{SolveDynamic} or \texttt{SolveStatic}
\ei
\item Very simple example \mybold{without loads} leads to error: \texttt{SolveDynamic} or \texttt{SolveStatic} \mybold{terminated due to errors}:
\bi
\item[$\ra$] see also 'Convergence problems', \refSection{sec:overview:basics:convergenceproblems}
\item[$\ra$] may be caused due to nonlinearity of formulation and round off errors, which restrict Newton to achieve desired tolerances; adjust  \texttt{.newton.relativeTolerance} / \texttt{.newton.absoluteTolerance} in static solver or in time integration
\ei
\item Typical \mybold{solver error due to redundant constraints or missing inertia terms}, could read as follows:
%\plainlststyle
\begin{lstlisting}
  =========================================
  SYSTEM ERROR [file 'C:\ProgramData\Anaconda3_64b37\lib\site-packages\exudyn\solver.py', line 207]: 
  CSolverBase::Newton: System Jacobian seems to be singular / not invertible!
  time/load step #1, time = 0.0002
  causing system equation number (coordinate number) = 42
  =========================================
\end{lstlisting}
\onlyRST{\rstStartNewLine}
%
\bi
\item[$\ra$] this solver error shows that equation 42 is not solvable. The according coordinate is shown later in such an error message:
\ei
\begin{lstlisting}
  ...
  The causing system equation 42 belongs to a algebraic variable (Lagrange multiplier)
  Potential object number(s) causing linear solver to fail: [7]
      object 7, name='object7', type=JointGeneric
\end{lstlisting}
\onlyRST{\rstStartNewLine}
%
\bi
\item[$\ra$] object 7 seems to be the reason, possibly there are too much (joint) constraints applied to your system, check this object.
\item[$\ra$] show typical REASONS and SOLUTIONS, by using \texttt{showHints=True} in \texttt{exu.SolveDynamic(...)} or \texttt{exu.SolveStatic(...)}
\item[$\ra$] You can also \mybold{highlight} object 7 by using the following code in the iPython console:
\ei
\pythonstyle\begin{lstlisting}
  exu.StartRenderer()
  HighlightItem(SC,mbs,7)
\end{lstlisting}
%
which draws the according object in red and others gray/transparent (but sometimes objects may be hidden inside other objects!). See the command's description for further options, e.g., to highlight nodes.
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\vspace{12pt}\\
\item Typical \mybold{solver error if Newton does not converge}:
\plainlststyle
\begin{lstlisting}
  +++++++++++++++++++++++++++++++
  EXUDYN V1.0.200 solver: implicit second order time integration
    Newton (time/load step #1): convergence failed after 25 iterations; relative error = 0.079958, time = 2
    Newton (time/load step #1): convergence failed after 25 iterations; relative error = 0.0707764, time = 1
    Newton (time/load step #1): convergence failed after 25 iterations; relative error = 0.0185745, time = 0.5
    Newton (time/load step #2): convergence failed after 25 iterations; relative error = 0.332953, time = 0.5
    Newton (time/load step #2): convergence failed after 25 iterations; relative error = 0.0783815, time = 0.375
    Newton (time/load step #2): convergence failed after 25 iterations; relative error = 0.0879718, time = 0.3125
    Newton (time/load step #2): convergence failed after 25 iterations; relative error = 2.84704e-06, time = 0.28125
    Newton (time/load step #3): convergence failed after 25 iterations; relative error = 1.9894e-07, time = 0.28125
  STEP348, t = 20 sec, timeToGo = 0 sec, Nit/step = 7.00575
  solver finished after 0.258349 seconds.
\end{lstlisting}
\onlyRST{\rstStartNewLine}
%
\bi
\item[$\ra$] this solver error is caused, because the nonlinear system cannot be solved using Newton's method.
\item[$\ra$] the static or dynamic solver by default tries to reduce step size to overcome this problem, but may fail finally (at minimum step size).
\item[$\ra$] possible reasons are: too large time steps (reduce step size by using more steps/second), inappropriate initial conditions, or inappropriate joints or constraints (remove joints to see if they are the reason), usually within a singular configuration. Sometimes a system may be just unsolvable in the way you set it up.
\item[$\ra$] see also 'Convergence problems', \refSection{sec:overview:basics:convergenceproblems}
\ei
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item Typical solver error if (e.g., syntax) \mybold{error in user function} (output may be very long, \mybold{read always message on top!}):
\begin{lstlisting}
  =========================================
  SYSTEM ERROR [file 'C:\ProgramData\Anaconda3_64b37\lib\site-packages\exudyn\solver.py', line 214]: 
  Error in Python USER FUNCTION 'LoadCoordinate::loadVectorUserFunction' (referred line number my be wrong!):
  NameError: name 'sin' is not defined

  At:
    C:\DATA\cpp\DocumentationAndInformation\tests\springDamperUserFunctionTest.py(48): Sweep
    C:\DATA\cpp\DocumentationAndInformation\tests\springDamperUserFunctionTest.py(54): userLoad
    C:\ProgramData\Anaconda3_64b37\lib\site-packages\exudyn\solver.py(214): SolveDynamic
    C:\DATA\cpp\DocumentationAndInformation\tests\springDamperUserFunctionTest.py(106): <module>
    C:\ProgramData\Anaconda3_64b37\lib\site-packages\spyder_kernels\customize\spydercustomize.py(377): exec_code
    C:\ProgramData\Anaconda3_64b37\lib\site-packages\spyder_kernels\customize\spydercustomize.py(476): runfile
    <ipython-input-14-323569bebfb4>(1): <module>
    C:\ProgramData\Anaconda3_64b37\lib\site-packages\IPython\core\interactiveshell.py(3331): run_code
  ...
  ...
  ; check your Python code!
  =========================================

  Solver stopped! use showHints=True to show helpful information
\end{lstlisting}
\onlyRST{\rstStartNewLine}
%
\bi
\item[$\ra$] this indicates an error in the user function \texttt{LoadCoordinate::loadVectorUserFunction}, because \texttt{sin} function has not been defined (must be imported, e.g., from \texttt{math}). It indicates that the error occurred in line 48 in \texttt{springDamperUserFunctionTest.py} within function \texttt{Sweep}, which has been called from function \texttt{userLoad}, etc.
\ei
\ei \vspace{12pt}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\mysubsubsection{FAQ}
\mybold{Some frequently asked questions}:
\bn
\item When \mybold{importing} \codeName in Python (windows) I get an error 
\bi
\item[$\ra$] see trouble shooting instructions above!
\ei
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item I do not understand the \mybold{Python errors} -- how can I find the reason of the error or crash?
\bi
\item[$\ra$] Read trouble shooting section above! 
\item[$\ra$] First, you should read all error messages and warnings: from the very first to the last message. Very often, there is a definite line number which shows the error. Note, that if you are executing a string (or module) as a Python code, the line numbers refer to the local line number inside the script or module.
\item[$\ra$] If everything fails, try to execute only part of the code to find out where the first error occurs. By omiting parts of the code, you should find the according source of the error.
\item[$\ra$] If you think, it is a bug: send an email with a representative code snippet, version, etc.\ to \texttt{ reply.exudyn@gmail.com}
\ei
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item Spyder \mybold{console hangs} up, does not show error messages, ...:
\bi
\item[$\ra$] very often a new start of Spyder helps; most times, it is sufficient to restart the kernel or to just press the 'x' in your IPython console, which closes the current session and restarts the kernel (this is much faster than restarting Spyder)
\item[$\ra$] restarting the IPython console also brings back all error messages
\ei
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item Where do I find the \mybold{'.exe' file}?
\bi
\item[$\ra$] \codeName is only available via the Python interface as a module '\texttt{exudyn}', the C++ code being inside of \texttt{exudynCPP.pyd}, which is located in the exudyn folder where you installed the package. This means that you need to \mybold{run Python} (best: Spyder) and import the \codeName module.
\ei
 %
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item I get the error message 'check potential mixing of different (object, node, marker, ...) indices', what does it mean?
\bi
\item[$\ra$] probably you used wrong item indexes, see beginning of command interface in \refSection{sec:PCpp:command:interface}. 
\item[$\ra$] E.g., an object number \texttt{oNum = mbs.AddObject(...)} is used at a place where a \texttt{NodeIndex} is expected, e.g., \texttt{mbs.AddObject(MassPoint(nodeNumber=oNum, ...))}
\item[$\ra$] Usually, this is an ERROR in your code, it does not make sense to mix up these indexes!
\item[$\ra$] In the exceptional case, that you want to convert numbers, see beginning of \refSection{sec:PCpp:command:interface}.
\ei
 %
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item Why does \mybold{type auto completion} / intellisense not work for mbs (MainSystem)?
\bi
\item[$\ra$] in earlier versions of \codeName type completion did not work properly for more complex structures
\item[$\ra$] since version 1.6.103 type completion works for most functions\, types and structures: tested in Spyder 5.2.2 and Visual Studio Code 1.78.1); with an added stub file (.pyi) the standard type completion fetches information about structures or functions; this even works for example with \texttt{SC.visualizationSettings.bodies.kinematicTree.showJointFrames}. If you still have problems, try to restart your environment / computer or switch to a different version, and create an issue on GitHub.
\ei
 %
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item How to add graphics?
\bi
\item[$\ra$] Graphics (lines, text, 3D triangular / \acs{STL} mesh) can be added to all BodyGraphicsData items in objects. Graphics objects which are fixed with the background can be attached to a ObjectGround object. Moving objects must be attached to the BodyGraphicsData of a moving body. Other moving bodies can be realized, e.g., by adding a ObjectGround and changing its reference with time. Furthermore, ObjectGround allows to add fully user defined graphics.
\ei
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item In \texttt{GenerateStraightLineANCFCable2D} 
\bi
\item[$\ra$] coordinate constraints can be used to constrain position and rotation, e.g., \texttt{fixedConstraintsNode0 = [1,1,0,1]} for a beam aligned along the global x-axis; 
\item[$\ra$] this \mybold{does not work} for beams with arbitrary rotation in reference configuration, e.g., 45\textdegree. Use a GenericJoint with a rotationMarker instead.
\ei
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item What is the difference between MarkerBodyPosition and MarkerBodyRigid?
\bi
\item[$\ra$] Position markers (and nodes) do not have information on the orientation (rotation). For that reason, there is a difference between position based and rigid-body based markers. In case of a rigid body attached to ground with a SpringDamper, you can use both, MarkerBodyPosition or MarkerBodyRigid, markers. For a prismatic joint, you will need a MarkerBodyRigid.
\ei
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item I get an error in \texttt{exu.SolveDynamic(mbs, ...)} OR in \texttt{exu.SolveStatic(mbs, ...)} but no further information -- how can I solve it?
\bi
\item[$\ra$] Typical \mybold{time integration errors} may look like:
\begin{lstlisting}
  File "C:/DATA/cpp/EXUDYN\_git/main/pythonDev/...<file name>", line XXX, in <module>
  solver.SolveSystem(...)
  SystemError: <built-in method SolveSystem of PyCapsule object at 0x0CC63590> returned a result with an error set
\end{lstlisting}
%
\item[$\ra$] The pre-checks, which are performed to enable a crash-free simulation are insufficient for your model
%
\item[$\ra$] As a first try, \mybold{restart the IPython console} in order to get all error messages, which may be blocked due to a previous run of \codeName.
%
\item[$\ra$] Very likely, you are using Python user functions inside \codeName: They lead to an internal Python error, which is not always catched by \codeName; e.g., a load user function UFload(mbs,~t,~load), which tries to access component load[3] of a load vector with 3 components will fail internally;
%
\item[$\ra$] Use the print(...) command in Python at many places to find a possible error in user functions (e.g., put \texttt{print("Start user function XYZ")} at the beginning of every user function; test user functions from iPython console
%
\item[$\ra$] It is also possible, that you are using inconsistent data, which leads to the crash. In that case, you should try to change your model: omit parts and find out which part is causing your error
%
\item[$\ra$] see also \mybold{I do not understand the Python errors -- how can I find the cause?}
\ei

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\item Why can't I get the focus of the simulation window on startup (render window hidden)?
\bi
\item[$\ra$] Starting \codeName out of Spyder might not bring the simulation window to front, because of specific settings in Spyder(version 3.2.8), e.g., Tools$\ra$Preferences$\ra$Editor$\ra$Advanced settings: uncheck 'Maintain focus in the Editor after running cells or selections'; Alternatively, set \texttt{SC.visualizationSettings.window.alwaysOnTop=True} \mybold{before} starting the renderer with \texttt{exu.StartRenderer()}
\ei
%
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\en


